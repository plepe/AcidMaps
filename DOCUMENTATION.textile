h2. Acid Maps Reference

AMS (Acid Map Server) is basically a web server that generates interpolated images from a set of valued points in real time. This means that you can use your existing datasets (e.g.: sales, temperature, etc...) to generate advanced visualizations: heatmaps, isolines and Voronoi diagrams.

Using the plugin of Acid Map for Geoserver, you can use a WMS layer of points to generate an AMS layer. You only need to add some additional parameters to WMS request.

This document assume that you are familiar with certains aspect of Geoserver:
* Configuration of Geoserver
* Version of Geoserver: 2.1 or greater.
* Create a WMS layer of points in Geoserver
* Familiarity with the WMS specification

h2. Configuring Geoserver for AcidMaps
* Download AcidMaps_2.0 from "https://github.com/XoomCode/AcidMaps/downloads":https://github.com/XoomCode/AcidMaps/downloads
* Copy AcidMaps library for to your system library path. For example, in linux, copy libacid-maps-jni.so to /usr/lib/
* Copy Geoserver acidmaps-*.jar to WEB-INF/lib of deployed

Now, you can use any WMS layer in Geoserver whose geographic data is a point and has a Numeric column to be interpolated. You only need to add some parameters to WMS request and Geoserver will return an AMS map. The AMS following parameters are defined:

h2. WMS valid parameters
* REQUEST: Define the type of request. Only GETMAP value is allowed.
* SERVICE: Define the server service. Only AMS value is allowed.
* LAYERS: The layer name. Only one layer is allowed.
* SRS: Defines the Spatial Reference System (projection or datum) that will be used to access or draw the information requested. This have to be the same that the SRS of the geographic data in database. AMS can't change the SRS of the data in runtime.
* BBOX: Sets the geographic box of the request
* WIDTH: Define the width of the map bitmap.
* HEIGHT: Define the width of the map bitmap.
* FORMAT: Defines the FORMAT of the map's bitmap in the MIME-type format. Only image/png or image/jpg values are allowed.
* CQL_FILTER: Defines the CQL filter.

h2. AMS parameters
* VALUE_COLUMN: Define the name of the layer column to be used for the interpolation.
* SIMPLIFY_METHOD: Defines the method to reduce the set of data to be interloped. Valid values are 0 ( Copy the first value ), 1 ( Uniform distributed grid ), 2 ( Random samples ), 3 ( Highest and lowest values ).
* SIMPLIFY_SIZE: Defines the size of the simplify sample.
* INTERVALS[]: Defines a set of real numbers with the property that any number that lies between two numbers in the set is also included in the set. Values must to be speared by comma: 10,20,45,70,100
* INTERVALS_COLORS[]: Define the RGBA color for each range specified in intervals parameter: Example: INTERVALS_COLORS[]=0xffffff80,0xff000080,0xffff0080,0x00ff0080,0x0000ff80
* RENDERER_TYPE: Determines how interpolated values are rendered. Valid values are: 0 (dense: Allows to set a color for each value generated by the interpolation), 1 ( sparse: Set the color defined in intervals_colors to the values that lies within the interval corresponding), 2 ( Generate an smooth color rendering )
* INTERPOLATION_STRATEGY: Defines the strategy used to interpolate missing values. Valid values are: 0 ( No interpolation is used ), 1 ( Nearest neighbor found ), 2 ( Value decays with distance ), 3 ( Simple implementation of inverse distance weighting), 4 ( Calculate quantil of surrounding data points )
* RADIUS: Defines the radius used by interpolation.
* RADIUS_METHOD: How to interpret radius. Valid values are: 0 ( Pixels on the resulting image ), 1 ( Units in underlying data). Default: 0.
* RADIUS_ZOOM_FACTOR: When RADIUS_METHOD=1 is used, works as an additional factor for radius dependent on current zoom level. Default: 1. A factor >1 increases the radius for lower zoom levels (zooming out).
* DISTANCE_METHOD: Defines how to calculate the weight of each point depending on the distance. Possible values: 0: linear decline to 0, 1: cos, 2: cos squared . Default: 0.
* RASTER: To improve speed you can reduce the number of calculated pixels, by setting a RASTER>1. Default: 1. Currently the value of the top-left pixel is distributed to the other pixels.

h3. AMS parameters for Gradient renderer (RENDERER_TYPE=2)
* OPACITY_METHOD: Which method should be used for opacity value. Valid values are: 0 ( Use 'A' channel of Interval Colors ), 1 ( Opacity from weight, see WEIGHTS and WEIGHTS_VALUES. Weight values will only be saved from INTERPOLATION_STRATEGY=4. ). Default: 0.
* WEIGHTS: Interval list for OPACITY_METHOD=1, e.g. "0,1,5".
* WEIGHTS_VALUES: Opacity for given weights, e.g. "0,64,255". Values inbetween will be interpolated. 0=transparent, 255=fully opaque.

h3. AMS parameters for "Quantil Map" (INTERPOLATION_STRATEGY=4)
* QUANTIL: Which quantil should be calculated (0.0 - 1.0).
* QUANTIL_METHOD: Determines how the Quantil will be calculated. Values: 0 (the exact quantil will be used), 1 (the average of the quantil +/- QUANTIL_OFFSET will be calculated), 2 (the average of the twice the quantil at QUANTIL and +/- QUANTIL_OFFSET will be calculated). Default: 0
* QUANTIL_OFFSET: Modifier for QUANTIL, see QUANTIL_METHOD. Default: 0.1. If QUANTIL +/- QUANTIL_OFFSET is <0 or >1, the Quantil at 0 resp. 1 will be used.

h2. Example of AMS request with OpenLayers:
<pre><code>
wms = new OpenLayers.Layer.WMS(
		"sf:bugsites - Untiled", "http://ams.xoomcode.com/geoserver/wms",
		{
			LAYERS: 'sf:bugsites',
			STYLES: '',
			format: format,
			VALUE_COLUMN:"cat",
			SIMPLIFY_METHOD: 3,
			SIMPLIFY_SIZE:90,
			'INTERVALS[]':"10,20,45,70,100",
			'INTERVALS_COLORS[]':"0xffffffcc,0xff0000cc,0xffff00cc,0x00ff00cc,0x0000ffcc",
			RENDERER_TYPE:2,
			INTERPOLATION_STRATEGY:2,
			RADIUS:40,
			SERVICE:"AMS"
		},
		{singleTile: true, ratio: 1} 
	);
</code></pre>

"Online OpenLayers demo":http://ams.xoomcode.com/html/index.html

h2. Ignored WMS parameters:

VERSION, TRANSPARENT, STYLES, BGCOLOR, EXCEPTIONS, TIME, ELEVATION, TILED

h2. "AcidMaps website":http://acidmaps.com/
